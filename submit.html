<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>Flag上繳</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap + Icons（用 CDN，Pages 最方便） -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <!-- 你原本的全站樣式（可留可不留） -->
  <link rel="stylesheet" href="./style.css">

  <!-- 新增：submit/flagset 這頁專用樣式 -->
  <link rel="stylesheet" href="./flagset.css">
</head>

<body class="flag-page">
  <!-- 背景層（星星 + waves） -->
  <div class="bg-layers" aria-hidden="true">
    <div class="stars" id="starHost"></div>
    <div class="waves">
      <div class="wave-layer layer1" data-speed="90"></div>
      <div class="wave-layer layer2" data-speed="55"></div>
      <div class="wave-layer layer3" data-speed="35"></div>
    </div>
  </div>

  <!-- 主要內容 -->
  <main class="content-shell" role="main">
    <div class="page-header">
      <h1 class="page-title"><i class="bi bi-flag-fill page-icon"></i> 繳交 Flag</h1>
      <p class="page-subtitle">輸入學號上繳 Flag，並查看排行榜。</p>
    </div>

    <div class="flagset-grid">
      <!-- 左側：查詢 + 上繳 -->
      <div class="left-col">
        <!-- 查詢 -->
        <section class="cardx">
          <div class="cardx-header">
            <h3 class="cardx-title"><i class="bi bi-search me-2"></i>學號查詢</h3>
            <p class="cardx-subtitle">輸入學號查看你目前的提交紀錄（若你的 API 有提供）</p>
          </div>
          <div class="cardx-body">
            <form id="searchForm" autocomplete="off">
              <div class="form-row">
                <input class="inputx" type="text" id="searchNo" placeholder="輸入學號" required maxlength="20">
                <button class="btnx primary" type="submit"><i class="bi bi-search me-1"></i>查詢</button>
              </div>
            </form>
            <div class="mt-2">
              <div id="searchResult" class="mini-result"></div>
              <small class="form-hint">提示：如果你沒有做 /api/search，這邊會顯示「未提供查詢 API」。</small>
            </div>
          </div>
        </section>

        <!-- 上繳 -->
        <section class="cardx mt-3">
          <div class="cardx-header">
            <h3 class="cardx-title"><i class="bi bi-send-check me-2"></i>上繳 Flag</h3>
            <p class="cardx-subtitle">輸入學號與 Flag 送出</p>
          </div>
          <div class="cardx-body">
            <form id="submitForm" autocomplete="off">
              <div class="form-col">
                <label class="labelx" for="studentId">學號</label>
                <input class="inputx" type="text" id="studentId" placeholder="例如：C111151142" required maxlength="20">
              </div>

              <div class="form-col mt-2">
                <label class="labelx" for="flag">Flag</label>
                <input class="inputx" type="text" id="flag" placeholder="FLAG{...}" required>
              </div>

              <div class="d-flex gap-2 mt-3">
                <button class="btnx primary flex-grow-1" type="submit">
                  <i class="bi bi-flag-fill me-1"></i>送出
                </button>
                <button class="btnx ghost" type="button" id="btnRefresh">
                  <i class="bi bi-arrow-clockwise me-1"></i>更新榜單
                </button>
              </div>

              <div class="mt-3" id="message"></div>
            </form>
          </div>
        </section>
      </div>

      <!-- 右側：排行榜 -->
      <div class="right-col">
        <section class="cardx rank-card">
          <div class="cardx-header with-action">
            <div>
              <h6 class="cardx-title small"><i class="bi bi-trophy-fill me-2"></i>總排行榜（提交數）</h6>
              <p class="cardx-subtitle">Top 10</p>
            </div>
            <button class="btnx ghost small" data-modal-trigger="lb-modal">More</button>
          </div>

          <div class="cardx-body compact">
            <ol class="rank-list compact" id="rankList"></ol>
          </div>
        </section>
      </div>
    </div>
  </main>

  <!-- Modal（More） -->
  <div id="modal-root" class="modal-host">
    <div class="modal-overlay" id="lb-modal" data-modal-background-click="true" style="display:none;">
      <div class="modal-container">
        <div class="modal-header">
          <h3><i class="bi bi-trophy-fill modal-title-icon"></i> 總排行榜 - 完整榜單</h3>
          <button class="modal-close-btn" type="button" title="關閉">×</button>
        </div>
        <div class="modal-content">
          <ol class="rank-list" id="rankListModal"></ol>
          <div class="text-muted mt-2" style="font-size:12px">
            註：如果你的 /api/leaderboard 只有回傳 Top10，這裡也會顯示同一份資料（你之後可再做 all=1）。
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="./flagset.js"></script>
</body>
</html>
